<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kanjistat">
<title>Introduction to kanjistat • kanjistat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to kanjistat">
<meta property="og:description" content="kanjistat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kanjistat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/kanjistat.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dschuhmacher/kanjistat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to kanjistat</h1>
            
            <h4 data-toc-skip class="date">2023-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dschuhmacher/kanjistat/blob/HEAD/vignettes/kanjistat.Rmd" class="external-link"><code>vignettes/kanjistat.Rmd</code></a></small>
      <div class="d-none name"><code>kanjistat.Rmd</code></div>
    </div>

    
    
<p>The kanjistat package offers tools for working with Japanese kanji
characters, which includes dictionary lookup, linguistic study,
statistical analysis, integration in plots and R objects, as well as
recreational use. This vignette explains the basic functionality.</p>
<div class="section level2">
<h2 id="working-with-kanji-in-the-r-console">Working with kanji in the R console<a class="anchor" aria-label="anchor" href="#working-with-kanji-in-the-r-console"></a>
</h2>
<p>Many functions in kanjistat take “a kanji” as input. If you have set
up a Japanese input method on your system or if you copy/paste
characters from somewhere (e.g., an online dictionary), you can pass the
kanji directly as a character object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dschuhmacher.github.io/kanjistat/">kanjistat</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/lookup.html">lookup</a></span><span class="op">(</span><span class="st">"猫"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; 猫 --&gt; ON: ビョウ | kun: ねこ | nanori: </span></span>
<span><span class="co">#&gt;        meaning: cat</span></span></code></pre></div>
<p>Alternatively, you can use the kanji’s Unicode codepoint and escape
it by <code>\u</code> if it has at most four hex digits or by
<code>\U</code> in general (up to eight hex digits). The latter is
currently only necessary for 303 out of the 13108 kanji in
KANJIDIC2.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"\u732b"</span></span>
<span><span class="co">#&gt; [1] "猫"</span></span>
<span><span class="fu"><a href="../reference/lookup.html">lookup</a></span><span class="op">(</span><span class="st">"\u732b"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 猫 --&gt; ON: ビョウ | kun: ねこ | nanori: </span></span>
<span><span class="co">#&gt;        meaning: cat</span></span>
<span><span class="co"># "\u{26951}" gives usually Error: invalid \u{xxxx} sequence</span></span>
<span><span class="st">"\U26951"</span></span>
<span><span class="co">#&gt; [1] "𦥑"</span></span>
<span><span class="st">"\U00026951"</span></span>
<span><span class="co">#&gt; [1] "𦥑"</span></span></code></pre></div>
<p>Whether this or any other (of the rarer) kanji are displayed
correctly still depends on whether the console font supports the
corresponding character. You can also use the kanjistat functions
codepointToKanji or kanjiToCodepoint to switch between codepoint and
character.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/codepoint.html">codepointToKanji</a></span><span class="op">(</span><span class="st">"26951"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "𦥑"</span></span>
<span><span class="fu"><a href="../reference/codepoint.html">kanjiToCodepoint</a></span><span class="op">(</span><span class="st">"猫"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; [1] "732b"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="kanji-data-included">Kanji data included<a class="anchor" aria-label="anchor" href="#kanji-data-included"></a>
</h2>
<p>Kanjistat comes with a certain amount of data on kanji. The tibbles
<code>kbase</code>, <code>kmorph</code> and the list
<code>kreadmean</code> provide basic information for the kanji, which is
mostly from <a href="https://www.edrdg.org/wiki/index.php/KANJIDIC_Project" class="external-link">KANJIDIC2</a>
(see <code>README.md</code> for all sources). For one or several given
kanji the information is most easily retrieved via the
<code>lookup</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lookup.html">lookup</a></span><span class="op">(</span><span class="st">"猫"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 猫 --&gt; ON: ビョウ | kun: ねこ | nanori: </span></span>
<span><span class="co">#&gt;        meaning: cat</span></span>
<span><span class="fu"><a href="../reference/lookup.html">lookup</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"猫"</span>,<span class="st">"犬"</span><span class="op">)</span>, <span class="st">"basic"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      kanji unicode strokes   class grade kanken jlpt wanikani frank frank_news read_on</span></span>
<span><span class="co">#&gt; 1305    猫    732b      11  jouyou     8  pre-2    2       15  1212       1702  ビョウ</span></span>
<span><span class="co">#&gt; 77      犬    72ac       4 kyouiku     1     10    4        2   899       1326    ケン</span></span>
<span><span class="co">#&gt;      read_kun mean</span></span>
<span><span class="co">#&gt; 1305     ねこ  cat</span></span>
<span><span class="co">#&gt; 77       いぬ  dog</span></span>
<span><span class="fu"><a href="../reference/lookup.html">lookup</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"猫"</span>,<span class="st">"犬"</span><span class="op">)</span>, <span class="st">"morphologic"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      kanji strokes radical radvar nelson_c idc  components  skip mean</span></span>
<span><span class="co">#&gt; 1305    猫      11      犬     犭     &lt;NA&gt; 品l 苗,田,犭,艹 1-3-8  cat</span></span>
<span><span class="co">#&gt; 77      犬       4      犬   &lt;NA&gt;     &lt;NA&gt;  囗          大 4-4-4  dog</span></span></code></pre></div>
<p>Search and selection of kanji is by the usual syntax for data.frames
or tibbles. E.g.,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kbase</span><span class="op">[</span><span class="va">kbase</span><span class="op">$</span><span class="va">strokes</span> <span class="op">&gt;</span> <span class="fl">30</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;       kanji unicode strokes   class grade kanken jlpt wanikani frank frank_news read_on</span></span>
<span><span class="co">#&gt; 9756     籲    7c72      32 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA      ユ</span></span>
<span><span class="co">#&gt; 12052    鱻    9c7b      33 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA    セン</span></span>
<span><span class="co">#&gt; 12161    麤    9ea4      33 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA      ソ</span></span>
<span><span class="co">#&gt; 12243    龖    9f96      32 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA    トウ</span></span>
<span><span class="co">#&gt; 12244    龗    9f97      33 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA    レイ</span></span>
<span><span class="co">#&gt; 12706    䯂    4bc2      34 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12906    灩    7069      32 hyougai    11   &lt;NA&gt;   NA       NA    NA         NA    エン</span></span>
<span><span class="co">#&gt;         read_kun               mean</span></span>
<span><span class="co">#&gt; 9756       よ.ぶ             appeal</span></span>
<span><span class="co">#&gt; 12052 あたらしい              fresh</span></span>
<span><span class="co">#&gt; 12161  はな.れる              rough</span></span>
<span><span class="co">#&gt; 12243  おそ.れる flight of a dragon</span></span>
<span><span class="co">#&gt; 12244       かみ               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12706       &lt;NA&gt;           numerous</span></span>
<span><span class="co">#&gt; 12906       なみ        overflowing</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">kbase</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">strokes</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 13</span></span></span>
<span><span class="co">#&gt;   kanji unicode   strokes class   grade kanken  jlpt wanikani frank frank_news read_on</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;hexmode&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 籲    7c72           32 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> ユ     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 鱻    9c7b           33 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> セン   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 麤    9ea4           33 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> ソ     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 龖    9f96           32 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> トウ   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 龗    9f97           33 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> レイ   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 䯂    4bc2           34 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 灩    7069           32 hyougai    11 <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> エン   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: read_kun &lt;chr&gt;, mean &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-more-kanji-data">Getting more kanji data<a class="anchor" aria-label="anchor" href="#getting-more-kanji-data"></a>
</h2>
<p>On the to-do-list for this package are convenience functions for
reading from common free kanji databases and transforming the data into
a suitable R format. Except for <a href="https://kanjivg.tagaini.net/" class="external-link">KanjiVG</a> (see next section), this
has not been implemented yet.</p>
</div>
<div class="section level2">
<h2 id="kanji-data-types">Kanji data types<a class="anchor" aria-label="anchor" href="#kanji-data-types"></a>
</h2>
<p><code>kanjistat</code> introduces the S3 classes
<code>kanjimat</code> and <code>kanjivec</code> to store kanji as
bitmaps and nested lists of stroke paths, respectively. The former are
produced by the user via the function <code>kanjimat</code>, specifing a
font-family and possibly further parameters. The latter may be produced
by the user via the function <code>kanjivec</code> based on data of the
fantastic <a href="https://kanjivg.tagaini.net/" class="external-link">KanjiVG project</a>.
For the Jōyō kanji, there is also a precompiled list available from the
<a href="https://github.com/dschuhmacher/kanjistat.data" class="external-link">kanjistat.data
repository</a>, which may be the more convenient choice.</p>
</div>
<div class="section level2">
<h2 id="working-with-japanese-fonts">Working with Japanese fonts<a class="anchor" aria-label="anchor" href="#working-with-japanese-fonts"></a>
</h2>
<p>For using Japanese script in plots, either for annotation, to depict
decomposition information or when producing bitmaps of kanji, you need
to tell kanjistat about Japanese fonts installed on your computer.</p>
<p>There are many free Japanese fonts available for download, including
those at <a href="https://www.freekanjifonts.com/" class="external-link uri">https://www.freekanjifonts.com/</a>, <a href="https://www.freejapanesefont.com/" class="external-link uri">https://www.freejapanesefont.com/</a>, and <a href="https://github.com/fontworks-fonts" class="external-link uri">https://github.com/fontworks-fonts</a>. Common terms for
font styles are Gothic (ゴシック, sans serif), Minchō (明朝, serif),
Kyōkasho (教科書, school textbook). Sho (書) generally indicates a
handwriting style, with the three main calligraphy styles being Kaisho
(楷書, regular script), Gyōsho (行書, semi-cursiv script), Sōsho (草書,
cursiv script). Sometimes the kanji 体 (-tai, for typeface) or something
else expressing style or type is added.</p>
<p>Follow the instructions for your operation system to install your
favorite fonts. You then need to make R aware of it, which is done via
the font management package <code>sysfonts</code>. The function
<code><a href="https://rdrr.io/pkg/sysfonts/man/font_files.html" class="external-link">sysfonts::font_files()</a></code> gives a list of fonts installed in
standard places on your operating system, but the list may be a little
overwhelming and it sometimes misses fonts that you have installed in
more special places. A useful tool for finding the path to a font you
know by name is <code><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">systemfonts::match_font</a></code> (not
<code>sysfonts</code>!). You may then add the font to the sysfonts
database.</p>
<p>Since installed font families and their locations depend on the
user’s operating system and setup, the remainder of this introduction
displays console output and plots from the author’s system.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pregenerated output, run on the author's system. Your mileage may vary.</span></span>
<span></span>
<span><span class="co"># Locate the free kaisho font by Nagayama Norio (previously installed)</span></span>
<span><span class="va">nagayama</span> <span class="op">&lt;-</span> <span class="fu">systemfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">match_font</a></span><span class="op">(</span><span class="st">"nagayama_kai"</span><span class="op">)</span></span>
<span><span class="va">nagayama</span></span>
<span><span class="co">#&gt; $path</span></span>
<span><span class="co">#&gt; [1] "/Users/dschuhm/Library/Fonts/nagayama_kai08.otf"</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $index</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; $features</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">hsans</span> <span class="op">&lt;-</span> <span class="fu">systemfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">match_font</a></span><span class="op">(</span><span class="st">"Hiragino Sans"</span><span class="op">)</span></span>
<span><span class="va">hmincho</span> <span class="op">&lt;-</span> <span class="fu">systemfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">match_font</a></span><span class="op">(</span><span class="st">"Hiragino Mincho ProN"</span><span class="op">)</span></span>
<span><span class="va">yukyokasho</span> <span class="op">&lt;-</span> <span class="fu">systemfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">match_font</a></span><span class="op">(</span><span class="st">"YuKyokasho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the font to the sysfonts database under the name given by `family`</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html" class="external-link">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"nagayama_kai"</span>, regular<span class="op">=</span><span class="va">nagayama</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html" class="external-link">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"hiragino_sans"</span>, regular<span class="op">=</span><span class="va">hsans</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html" class="external-link">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"hiragino_mincho"</span>, regular<span class="op">=</span><span class="va">hmincho</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html" class="external-link">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"yu_kyokasho"</span>, regular<span class="op">=</span><span class="va">yukyokasho</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the fonts families in the sysfonts database</span></span>
<span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_families.html" class="external-link">font_families</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sans"            "serif"           "mono"            "nagayama_kai"    "hiragino_sans"</span></span>
<span><span class="co">#&gt; [6] "hiragino_mincho" "yu_kyokasho"</span></span></code></pre></div>
<p>⚠️ <strong>Adding fonts to the sysfont database is only effective
until the end of the session. It is therefore advisable to add the
<code>font_add</code> commands to your kanjistat profile file; see the
last section of this document.</strong></p>
<p>Once the fonts are in the sysfonts database, we can use them in plots
in many ways we like thanks to the package <code>showtext</code>. A
first obvious example is for plot annotation.
<!-- for a single kanji take width and height = 3 --></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pregenerated output, run on the author's system. Your mileage may vary.</span></span>
<span></span>
<span><span class="fu">showtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html" class="external-link">showtext_auto</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># give control for displaying text in plots to package `showtext`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># data</span></span>
<span><span class="va">petpercent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11.1</span>, <span class="fl">9.6</span>, <span class="fl">3.5</span>, <span class="fl">2.2</span>, <span class="fl">1.6</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">petshort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">petpercent</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">petpercent</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">17</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">petnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"犬"</span>, <span class="st">"猫"</span>, <span class="st">"メダカ"</span>, <span class="st">"金魚"</span>, <span class="st">"カメ"</span>, <span class="st">"小鳥"</span>, <span class="st">"熱帯魚"</span>, <span class="st">"その他"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot and annotate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">petshort</span>, las<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"darkolivegreen3"</span>, <span class="co"># names.arg=petnames does not position nicely</span></span>
<span>        main<span class="op">=</span><span class="st">"ペット現在飼育状況 (2002年)\n (Pet Ownership 2022 in Japan)"</span>, family<span class="op">=</span><span class="st">"hiragino_mincho"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="va">petnames</span>, side<span class="op">=</span><span class="fl">1</span>, line<span class="op">=</span><span class="fl">0.35</span>, at<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1.2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"hiragino_mincho"</span><span class="op">)</span></span>
<span>  <span class="co"># bars have width 1 and space 0.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"%"</span>, side<span class="op">=</span><span class="fl">2</span>, line<span class="op">=</span><span class="fl">0.5</span>, at<span class="op">=</span><span class="fl">11</span>, las<span class="op">=</span><span class="fl">1</span>, family<span class="op">=</span><span class="st">"hiragino_mincho"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Source: ペットフード協会 (https://petfood.or.jp/data/)"</span>, side<span class="op">=</span><span class="fl">1</span>, line<span class="op">=</span><span class="fl">2</span>,</span>
<span>      family<span class="op">=</span><span class="st">"hiragino_mincho"</span>, cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">showtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html" class="external-link">showtext_auto</a></span><span class="op">(</span>enable <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># give back control to the usual R code</span></span></code></pre></div>
<p><img src="figures/japanese_pets.svg" style="width:90.0%"></p>
<p>The function <code>plotkanji</code> provides a simple way of
depicting individual kanji in a graphics device.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pregenerated output, run on the author's system. Your mileage may vary.</span></span>
<span><span class="fu"><a href="../reference/plotkanji.html">plotkanji</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"猫"</span>,<span class="fl">4</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hiragino_sans"</span>, <span class="st">"hiragino_mincho"</span>, <span class="st">"yu_kyokasho"</span>, <span class="st">"nagayama_kai"</span><span class="op">)</span>,</span>
<span>          height<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/four_cats.png" style="width:90.0%"></p>
</div>
<div class="section level2">
<h2 id="kanjimat-objects">kanjimat objects<a class="anchor" aria-label="anchor" href="#kanjimat-objects"></a>
</h2>
<p>The function <code>kanjimat</code> produces a bitmap representation
of the kanji in the specified font that is stored in an object of class
<code>kanjimat</code> along with other information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pregenerated output, run on the author's system. Your mileage may vary.</span></span>
<span><span class="va">fuji</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kanjimat.html">kanjimat</a></span><span class="op">(</span>kanji<span class="op">=</span><span class="st">"藤"</span>, family<span class="op">=</span><span class="st">"nagayama_kai"</span>, size <span class="op">=</span> <span class="fl">128</span><span class="op">)</span></span>
<span><span class="va">fuji</span></span>
<span><span class="co">#&gt; Kanjimat representation of 藤 (Unicode 85e4)</span></span>
<span><span class="co">#&gt; 128x128 bitmap in nagayama_kai font with 0 margin, antialiased</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fuji</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ char     : chr "藤"</span></span>
<span><span class="co">#&gt;  $ hex      : 'hexmode' int 85e4</span></span>
<span><span class="co">#&gt;  $ padhex   : chr "085e4"</span></span>
<span><span class="co">#&gt;  $ family   : chr "nagayama_kai"</span></span>
<span><span class="co">#&gt;  $ size     : num 128</span></span>
<span><span class="co">#&gt;  $ margin   : num 0</span></span>
<span><span class="co">#&gt;  $ antialias: logi TRUE</span></span>
<span><span class="co">#&gt;  $ matrix   : num [1:128, 1:128] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "call")= chr "kanjimat(kanji = \"藤\", family = \"nagayama_kai\", size = 128)"</span></span>
<span><span class="co">#&gt;  - attr(*, "kanjistat_version")=Classes 'package_version', 'numeric_version'  hidden list of 1</span></span>
<span><span class="co">#&gt;   ..$ : int [1:3] 0 8 0</span></span>
<span><span class="co">#&gt;  - attr(*, "Rversion")= chr "R version 4.3.0 (2023-04-21)"</span></span>
<span><span class="co">#&gt;  - attr(*, "platform")= chr "x86_64-apple-darwin20"</span></span>
<span><span class="co">#&gt;  - attr(*, "png_type")= chr "cairo"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "kanjimat"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fuji</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/fuji.png"></p>
</div>
<div class="section level2">
<h2 id="the-kanjistat-profile-file">The kanjistat profile file<a class="anchor" aria-label="anchor" href="#the-kanjistat-profile-file"></a>
</h2>
<p>When kanjistat is loaded, it tries to source the file
<code>.Rkanjistat-profile</code>, first from the current R working
directory and if none is found from the users home directory. Having
such a file is optional but can be helpful in particular for the
following three tasks:</p>
<ul>
<li>Adding fonts to the <code>sysfonts</code> database as described
above for the duration of the current R session. For this, include lines
of the form</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sysfonts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html" class="external-link">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"nagayama_kai"</span>, regular<span class="op">=</span><span class="st">"/Users/dschuhm/Library/Fonts/nagayama_kai08.otf"</span><span class="op">)</span></span></code></pre></div>
<p>where <code>regular</code> is obtained from
<code><a href="https://rdrr.io/pkg/systemfonts/man/match_font.html" class="external-link">systemfonts::match_font</a></code>.</p>
<ul>
<li>Setting kanjistat options via <code>kanjistat_options</code>.
Options are mostly default choices for various functions. These options
are mentioned in the help of the function. Example:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/options.html">kanjistat_options</a></span><span class="op">(</span>ask_github <span class="op">=</span> <span class="cn">TRUE</span>, default_bitmap_size <span class="op">=</span> <span class="fl">64</span>, default_font <span class="op">=</span> <span class="st">"yu_kyokasho"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Loading further kanji data. For now, this concerns mainly the list
of pregenerated kanjivec objects obtained from <a href="https://github.com/dschuhmacher/kanjistat.data" class="external-link">kanjistat.data
repository</a>. After saving the .rda file locally, load by adding the
following line to <code>.Rkanjistat-profile</code>
</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"/path/to/the/data/kvec.rda"</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dominic Schuhmacher.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
